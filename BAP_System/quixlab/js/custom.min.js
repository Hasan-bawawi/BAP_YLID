jQuery(window).on("load", function() {
    $('#preloader').fadeOut(500);
    $('#main-wrapper').addClass('show');

    $('body').attr('data-sidebar-style') === "mini" ? $(".hamburger").addClass('is-active') : $(".hamburger").removeClass('is-active')
});

(function($) {
    "use strict";

    $('#menu').metisMenu();


    $('.nk-nav-scroll').slimscroll({
        position: "right",
        size: "5px",
        height: "100%",
        color: "transparent"
    });



    $(".nav-control").on('click', function() {

        $('#main-wrapper').toggleClass("menu-toggle");

        $(".hamburger").toggleClass("is-active");
    });


    //$(function () {
    //    var currentFile = window.location.pathname.toLowerCase().split('/').pop().split('.')[0]; // ambil "Master_BranchBAP" tanpa .aspx
    //    console.log("Current file:", currentFile);

    //    var activeLink = $("#menu a").filter(function () {
    //        var linkFile = this.pathname.toLowerCase().split('/').pop().split('.')[0];
    //        return linkFile === currentFile;
    //    });

    //    console.log("Matching links:", activeLink.length);

    //    if (activeLink.length) {
    //        activeLink.addClass("active");
    //        activeLink.closest("li").addClass("active");

    //        var parentUl = activeLink.closest("ul");
    //        var parentLi = parentUl.closest("li");

    //        parentUl.addClass("mm-show").attr("aria-expanded", "true");
    //        parentLi.children("a.has-arrow").attr("aria-expanded", "true");
    //        parentLi.addClass("active");
    //    }
    //});

    //$(function () {
    //    // Inisialisasi MetisMenu dulu
    //    $('#menu').metisMenu();

    //    // Setelah MetisMenu siap, baru jalankan penandaan active
    //    setTimeout(function () {
    //        var currentFile = window.location.pathname.toLowerCase().split('/').pop().split('.')[0];

    //        var activeLink = $("#menu a").filter(function () {
    //            var linkFile = this.pathname.toLowerCase().split('/').pop().split('.')[0];
    //            return linkFile === currentFile;
    //        });

    //        if (activeLink.length) {
    //            activeLink.addClass("active");

    //            var parentUl = activeLink.closest("ul");
    //            var parentLi = parentUl.closest("li");

    //            // Gunakan .trigger("click") untuk membuka submenu via MetisMenu
    //            var arrowLink = parentLi.children("a.has-arrow");
    //            if (arrowLink.length) {
    //                arrowLink.trigger("click");
    //            }
    //        }
    //    }, 10); // Delay kecil agar MetisMenu sempat inisialisasi
    //});

    $(function () {


        var currentFile = window.location.pathname.toLowerCase().split('/').pop().split('.')[0];

        var activeLink = $("#menu a").filter(function () {
            var linkFile = this.pathname.toLowerCase().split('/').pop().split('.')[0];
            return linkFile === currentFile;
        });

        if (activeLink.length) {
            // Tambahkan class active ke link
            activeLink.addClass("active");

            // Tambahkan class active ke parent <li>
            var parentLi = activeLink.parent();
            parentLi.addClass("active");

            // Buka semua parent <ul> dengan class "in"
            activeLink
                .parents("ul")
                .addClass("in")
                .attr("aria-expanded", "true");

            // Tambahkan class active ke semua parent <li>
            activeLink
                .parents("li")
                .addClass("active")
                .children("a.has-arrow")
                .attr("aria-expanded", "true");
        }
    });

    $(function() {
        var win_h = window.outerHeight;
        if (win_h > 0 ? win_h : screen.height) {
            $(".content-body").css("min-height", (win_h + 60) + "px");
        };
    });





    $('.selectpicker').selectpicker();



    $('[data-toggle="popover"]').popover();
    $('[data-toggle="tooltip"]').tooltip();


  

    const headerHight = $('.header').innerHeight();

    $(window).scroll(function() {
        if($('body').attr('data-layout') === "horizontal" && $('body').attr('data-header-position') === "static" && $('body').attr('data-sidebar-position') === "fixed")
            $(this.window).scrollTop() >= headerHight ? $('.metismenu').addClass('fixed') :  $('.metismenu').removeClass('fixed')
    });

    $('.sidebar-right-trigger').on('click', function() {
        $('.sidebar-right').toggleClass('show');
    });






})(jQuery);
